<div class="insights-section">
  <header class="section-header">
    <h3>Insights & Metadata</h3>
    @if (insights) {
      <div class="badge-row">
        @if (insights.badges) {
          <span
            class="insight-badge"
            [class]="
              (
                insights.badges.maturity?.label ||
                insights.badges.maturity ||
                ''
              ).toLowerCase()
            "
            [attr.title]="insights.badges.maturity?.description"
          >
            {{ insights.badges.maturity?.label || insights.badges.maturity }}
          </span>
          <span
            class="insight-badge"
            [class]="
              (
                insights.badges.maintenance?.label ||
                insights.badges.maintenance ||
                ''
              ).toLowerCase()
            "
            [attr.title]="insights.badges.maintenance?.description"
          >
            {{
              insights.badges.maintenance?.label || insights.badges.maintenance
            }}
          </span>
          <span
            class="insight-badge complexity"
            [attr.title]="insights.badges.complexity?.description"
          >
            {{
              insights.badges.complexity?.label || insights.badges.complexity
            }}
          </span>
          <span
            class="insight-badge activity"
            [class]="
              (
                insights.badges.activity_level?.label ||
                insights.badges.activity_level ||
                ''
              ).toLowerCase()
            "
            [attr.title]="insights.badges.activity_level?.description"
          >
            @if (
              insights.badges.activity_level?.label ||
              insights.badges.activity_level
            ) {
              {{
                insights.badges.activity_level?.label ||
                  insights.badges.activity_level
              }}
              Activity
            }
          </span>
        }
      </div>
    }
  </header>

  <div class="insights-grid">
    <!-- Hero Row: Commit Activity Graph -->
    <div class="glass-card graph-card">
      @if (insights) {
        <app-commit-graph
          [activity]="insights.commit_activity"
        ></app-commit-graph>
      }
      @if (loading) {
        <div class="loading-overlay">
          <div class="skeleton-line graph"></div>
        </div>
      }
    </div>

    <!-- Micro-Insight Cards Row -->
    @if (insights) {
      <div class="stats-row">
        <div class="stat-item glass-card">
          <span class="label">Project Age</span>
          <span class="value">{{ insights.stats.age_years }} Years</span>
        </div>
        <div class="stat-item glass-card">
          <span class="label">Recent Commits</span>
          <span class="value">{{ insights.stats.recent_commits }}</span>
        </div>
        <div class="stat-item glass-card">
          <span class="label">Latest Release</span>
          <span class="value">{{ insights.stats.release_recency }}</span>
        </div>
        <div
          class="stat-item glass-card"
          [class]="(insights.stats?.health || '').toLowerCase()"
        >
          <span class="label">Repository Health</span>
          <span class="value">{{ insights.stats?.health }}</span>
        </div>
        <div class="stat-item glass-card">
          <span class="label">Vibe & Size</span>
          <span class="value"
            >{{ insights.stats.vibe }} â€¢ {{ insights.stats.size_mb }} MB</span
          >
        </div>
      </div>
    }
  </div>
</div>
